<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>CLStencil Sample: Runs Request Handler DLLs or SRF Files from the Command Line</title></head><body><h1>CLStencil Sample: Runs Request Handler DLLs or SRF Files from the Command Line</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>Demonstrates how to provide custom implementations of <MSHelp:link keywords="2FC5FADE-7CEB-4F6C-80A1-ECCADE03C59D" tabindex="0" >IHttpServerContext</MSHelp:link> and <MSHelp:link keywords="F17A798D-F277-422F-A9DB-2E36374BDB37" tabindex="0" >IIsapiExtension</MSHelp:link> to create a command-line tool for generating responses from SRF files and Web application DLLs without requiring IIS.</p><p>Note that CLStencil only provides a partial implementation of <b>IHttpServerContext</b> and <b>CIsapiExtension</b>. Items that are specific to a Web server, such as <MSHelp:link keywords="CA46AE44-41B1-470C-8890-F3C2AFC711E5" tabindex="0" >IHttpServerContext::MapUrlToPathEx</MSHelp:link>, are not supported.</p><p>CLStencil tries to locate server variables in the current environment, so if the request handler needs a specific server variable, be sure to set it in the environment before running the application. For example, you can run the following command at a command prompt to make the SERVER_PROTOCOL variable available to CLStencil and the request handlers it loads:</p><p><b>SET SERVER_PROTOCOL=HTTP/1.1.</b></p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><p>It is not necessary to build this sample to see the tool in action. The executable file (clstencil.exe) is shipped with Visual Studio in the Vc7\bin directory. Instructions for use can be found below:</p><h4 class="subHeading">To use CLStencil</h4><div class="subSection"><ul><li><p>Run clstencil.exe from the command line using the following command: </p><p><b>clstencil</b> <b>i</b> <i>SrfFile</i> <b>o</b> <i>OutputFile</i> <b>e</b> <i>ErrorFile</i></p><p>Where:  </p><p><i>SrfFile</i>   The name of the SRF file to be processed.  </p><p><i>OutputFile</i>   The name of the file to which the generated content will be written.  </p><p><i>ErrorFile</i>   The name of the file to which warning and error messages will be written.  </p><p>Run clstencil.exe with no arguments for more information on its command line arguments. </p></li></ul></div><sections ><h4 class="subHeading" xmlns="">Demonstrates</h4><div class="subSection" xmlns=""><p><MSHelp:link keywords="2FC5FADE-7CEB-4F6C-80A1-ECCADE03C59D" tabindex="0" >IHttpServerContext</MSHelp:link> | <MSHelp:link keywords="F17A798D-F277-422F-A9DB-2E36374BDB37" tabindex="0" >IIsapiExtension</MSHelp:link> | <MSHelp:link keywords="AB1E3209-A312-4947-8BC4-A2C0F2C76E67" tabindex="0" >AtlServerRequest</MSHelp:link></p></div></sections></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :CLStencil Sample: Runs Request Handler DLLs or SRF Files from the Command Line">comments</a> about this topic to Microsoft.
      </div></div></body></html>
